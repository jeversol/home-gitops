apiVersion: v1
kind: ConfigMap
metadata:
  name: renovate-bin
  namespace: renovate
  labels:
    app.kubernetes.io/name: renovate
    app.kubernetes.io/part-of: renovate
binaryData:
  github-app-token.js: IyEvdXNyL2Jpbi9lbnYgbm9kZQpjb25zdCBmcyA9IHJlcXVpcmUoJ2ZzJyk7CmNvbnN0IGh0dHBzID0gcmVxdWlyZSgnaHR0cHMnKTsKY29uc3QgY3J5cHRvID0gcmVxdWlyZSgnY3J5cHRvJyk7CgpmdW5jdGlvbiBiYXNlNjR1cmwob2JqKSB7CiAgY29uc3QgYnVmID0gQnVmZmVyLmlzQnVmZmVyKG9iaikgPyBvYmogOiBCdWZmZXIuZnJvbShKU09OLnN0cmluZ2lmeShvYmopKTsKICByZXR1cm4gYnVmCiAgICAudG9TdHJpbmcoJ2Jhc2U2NCcpCiAgICAucmVwbGFjZSgvPS9nLCAnJykKICAgIC5yZXBsYWNlKC9cKy9nLCAnLScpCiAgICAucmVwbGFjZSgvXC8vZywgJ18nKTsKfQoKZnVuY3Rpb24gZXhpdFdpdGhFcnJvcihtZXNzYWdlLCBkZXRhaWwpIHsKICBjb25zb2xlLmVycm9yKG1lc3NhZ2UpOwogIGlmIChkZXRhaWwpIHsKICAgIGNvbnNvbGUuZXJyb3IoZGV0YWlsKTsKICB9CiAgcHJvY2Vzcy5leGl0KDEpOwp9Cgpjb25zdCBhcHBJZCA9IHByb2Nlc3MuZW52LlJFTk9WQVRFX0dJVEhVQl9BUFBfSUQ7CmNvbnN0IGluc3RhbGxhdGlvbklkID0gcHJvY2Vzcy5lbnYuUkVOT1ZBVEVfR0lUSFVCX0FQUF9JTlNUQUxMQVRJT05fSUQ7CmNvbnN0IHJhd0tleSA9IHByb2Nlc3MuZW52LlJFTk9WQVRFX0dJVEhVQl9BUFBfUFJJVkFURV9LRVk7CgppZiAoIWFwcElkIHx8ICFpbnN0YWxsYXRpb25JZCB8fCAhcmF3S2V5KSB7CiAgZXhpdFdpdGhFcnJvcignTWlzc2luZyBHaXRIdWIgQXBwIGNyZWRlbnRpYWxzIGluIGVudmlyb25tZW50Jyk7Cn0KCmNvbnN0IHByaXZhdGVLZXkgPSByYXdLZXkucmVwbGFjZSgvXHI/XG4vZywgJ1xuJyk7Cgpjb25zdCBub3cgPSBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKTsKY29uc3QgaGVhZGVyID0geyBhbGc6ICdSUzI1NicsIHR5cDogJ0pXVCcgfTsKY29uc3QgcGF5bG9hZCA9IHsgaWF0OiBub3cgLSA2MCwgZXhwOiBub3cgKyA1NDAsIGlzczogYXBwSWQgfTsKCmNvbnN0IHVuc2lnbmVkID0gYCR7YmFzZTY0dXJsKGhlYWRlcil9LiR7YmFzZTY0dXJsKHBheWxvYWQpfWA7CmNvbnN0IHNpZ25lciA9IGNyeXB0by5jcmVhdGVTaWduKCdSU0EtU0hBMjU2Jyk7CnNpZ25lci51cGRhdGUodW5zaWduZWQpOwpzaWduZXIuZW5kKCk7CmNvbnN0IHNpZ25hdHVyZSA9IGJhc2U2NHVybChzaWduZXIuc2lnbihwcml2YXRlS2V5KSk7CmNvbnN0IGp3dCA9IGAke3Vuc2lnbmVkfS4ke3NpZ25hdHVyZX1gOwoKY29uc3Qgb3B0aW9ucyA9IHsKICBob3N0bmFtZTogJ2FwaS5naXRodWIuY29tJywKICBwYXRoOiBgL2FwcC9pbnN0YWxsYXRpb25zLyR7aW5zdGFsbGF0aW9uSWR9L2FjY2Vzc190b2tlbnNgLAogIG1ldGhvZDogJ1BPU1QnLAogIGhlYWRlcnM6IHsKICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHtqd3R9YCwKICAgIEFjY2VwdDogJ2FwcGxpY2F0aW9uL3ZuZC5naXRodWIranNvbicsCiAgICAnVXNlci1BZ2VudCc6ICdyZW5vdmF0ZS1zZWxmLWhvc3RlZCcKICB9Cn07Cgpjb25zdCByZXEgPSBodHRwcy5yZXF1ZXN0KG9wdGlvbnMsIHJlcyA9PiB7CiAgbGV0IGJvZHkgPSAnJzsKICByZXMub24oJ2RhdGEnLCBjaHVuayA9PiB7IGJvZHkgKz0gY2h1bms7IH0pOwogIHJlcy5vbignZW5kJywgKCkgPT4gewogICAgaWYgKHJlcy5zdGF0dXNDb2RlIDwgMjAwIHx8IHJlcy5zdGF0dXNDb2RlID49IDMwMCkgewogICAgICBleGl0V2l0aEVycm9yKGBHaXRIdWIgQVBJIHJlc3BvbmRlZCB3aXRoIHN0YXR1cyAke3Jlcy5zdGF0dXNDb2RlfWAsIGJvZHkpOwogICAgfQogICAgdHJ5IHsKICAgICAgY29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZShib2R5KTsKICAgICAgaWYgKCFwYXJzZWQudG9rZW4pIHsKICAgICAgICBleGl0V2l0aEVycm9yKCdHaXRIdWIgcmVzcG9uc2UgbWlzc2luZyB0b2tlbicsIGJvZHkpOwogICAgICB9CiAgICAgIGZzLndyaXRlRmlsZVN5bmMoJy9yZW5vdmF0ZS1hdXRoL3Rva2VuJywgcGFyc2VkLnRva2VuLCB7IG1vZGU6IDBvNjAwIH0pOwogICAgICBjb25zdCBpbnN0YWxsSWQgPSBwYXJzZWQuaWQgPyBTdHJpbmcocGFyc2VkLmlkKSA6ICcnOwogICAgICBmcy53cml0ZUZpbGVTeW5jKCcvcmVub3ZhdGUtYXV0aC9pbnN0YWxsYXRpb24taWQnLCBpbnN0YWxsSWQsIHsgbW9kZTogMG82MDAgfSk7CiAgICAgIHByb2Nlc3MuZXhpdCgwKTsKICAgIH0gY2F0Y2ggKGVycikgewogICAgICBleGl0V2l0aEVycm9yKCdGYWlsZWQgdG8gcGFyc2UgR2l0SHViIHJlc3BvbnNlJywgZXJyKTsKICAgIH0KICB9KTsKfSk7CgpyZXEub24oJ2Vycm9yJywgZXJyID0+IGV4aXRXaXRoRXJyb3IoJ1JlcXVlc3QgZmFpbGVkJywgZXJyKSk7CnJlcS5lbmQoKTsK
