---
apiVersion: autoscaling.k8s.io/v1
kind: VerticalPodAutoscaler
metadata:
  name: scrutiny-vpa
  namespace: scrutiny
spec:
  targetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: scrutiny
  updatePolicy:
    updateMode: "Off"  # Recommendation-only mode
  resourcePolicy:
    containerPolicies:
      - containerName: scrutiny
        minAllowed:
          cpu: 25m
          memory: 64Mi
        maxAllowed:
          cpu: 200m       # SMART monitoring web UI
          memory: 256Mi   # SMART monitoring web UI
        controlledResources: ["cpu", "memory"]
        controlledValues: RequestsAndLimits
---
apiVersion: autoscaling.k8s.io/v1
kind: VerticalPodAutoscaler
metadata:
  name: scrutiny-influxdb-vpa
  namespace: scrutiny
spec:
  targetRef:
    apiVersion: apps/v1
    kind: StatefulSet
    name: influxdb
  updatePolicy:
    updateMode: "Off"  # Recommendation-only mode
  resourcePolicy:
    containerPolicies:
      - containerName: influxdb2
        minAllowed:
          cpu: 50m
          memory: 128Mi
        maxAllowed:
          cpu: 500m       # Time-series database
          memory: 1Gi     # Time-series database
        controlledResources: ["cpu", "memory"]
        controlledValues: RequestsAndLimits